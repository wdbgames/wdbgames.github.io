<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background: #111;
        color: white;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <script>
      const coverURL = "https://cdn.jsdelivr.net/gh/gn-math/covers@main";
      const htmlURL = "https://cdn.jsdelivr.net/gh/gn-math/html@main";
      const zonesurls = ["https://cdn.jsdelivr.net/%67%68/%67%6e%2d%6d%61%74%68/%61%73%73%65%74%73@%6d%61%69%6e/%7a%6f%6e%65%73%2e%6a%73%6f%6e", "https://cdn.jsdelivr.net/gh/gn-math/assets@latest/zones.json", "https://cdn.jsdelivr.net/gh/gn-math/assets@master/zones.json", "https://cdn.jsdelivr.net/gh/gn-math/assets/zones.json"];
      let zones = [];
      async function listZones() {
        try {
          let sha;
          let selectedSource = zonesurls[Math.floor(Math.random() * zonesurls.length)];
          try {
            const sharesponse = await fetch(selectedSource + "?t=" + Date.now());
            if (sharesponse.ok) {
              const shajson = await sharesponse.json();
              sha = Array.isArray(shajson) ? shajson[0]['sha'] : null;
            }
          } catch (e) {
            console.warn("primary fetch failed");
          }
          if (!sha) {
            try {
              const secondary = await fetch("https://raw.githubusercontent.com/gn-math/xml/refs/heads/main/sha.txt?t=" + Date.now());
              if (secondary.ok) sha = (await secondary.text()).trim();
            } catch (e) {
              console.error("sha fallback failed");
            }
          }
          const zonesFinalURL = sha ? `https://cdn.jsdelivr.net/gh/gn-math/assets@${sha}/zones.json?t=` + Date.now() : `https://cdn.jsdelivr.net/gh/gn-math/assets/zones.json`;
          const response = await fetch(zonesFinalURL);
          zones = await response.json();
          const search = new URLSearchParams(window.location.search);
          const id = search.get('id');
          if (id) {
            const zone = zones.find(z => String(z.id) === String(id));
            if (zone) {
              loadZoneContent(zone);
            }
          }
        } catch (error) {}
      }

      function loadZoneContent(zone) {
        if (zone.url.startsWith("http")) {
          window.location.href = zone.url;
        } else {
          const finalUrl = zone.url.replace("{COVER_URL}", coverURL).replace("{HTML_URL}", htmlURL);
          fetch(finalUrl + "?t=" + Date.now()).then(res => {
            if (!res.ok) throw new Error("404");
            return res.text();
          }).then(html => {
            document.documentElement.innerHTML = html;
            document.documentElement.querySelectorAll('script').forEach(oldScript => {
              const newScript = document.createElement('script');
              if (oldScript.src) newScript.src = oldScript.src;
              else newScript.textContent = oldScript.textContent;
              document.body.appendChild(newScript);
            });
          }).catch(err => {});
        }
      }
      listZones();
    </script>
  </body>
</html>